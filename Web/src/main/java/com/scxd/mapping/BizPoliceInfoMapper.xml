<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.scxd.dao.mapper.BizPoliceInfoMapper">
    <resultMap id="BaseResultMap" type="com.scxd.beans.pojo.BizPoliceInfo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="ID" property="id" jdbcType="VARCHAR"/>
        <result column="RYLX" property="rylx" jdbcType="CHAR"/>
        <result column="XM" property="xm" jdbcType="VARCHAR"/>
        <result column="RYBH" property="rybh" jdbcType="VARCHAR"/>
        <result column="SFZMHM" property="sfzmhm" jdbcType="VARCHAR"/>
        <result column="SJHM" property="sjhm" jdbcType="VARCHAR"/>
        <result column="BMDM" property="bmdm" jdbcType="VARCHAR"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        ID, RYLX, XM, RYBH, SFZMHM, SJHM, BMDM
    </sql>
    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        <include refid="Base_Column_List"/>
        from BIZ_POLICE_INFO
        where ID = #{id,jdbcType=VARCHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from BIZ_POLICE_INFO
        where ID = #{id,jdbcType=VARCHAR}
    </delete>
    <insert id="insert" parameterType="com.scxd.beans.pojo.BizPoliceInfo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into BIZ_POLICE_INFO (ID, RYLX, XM, RYBH,
        SFZMHM, SJHM, BMDM)
        values (#{id,jdbcType=VARCHAR}, #{rylx,jdbcType=CHAR}, #{xm,jdbcType=VARCHAR}, #{rybh,jdbcType=VARCHAR},
        #{sfzmhm,jdbcType=VARCHAR}, #{sjhm,jdbcType=VARCHAR}, #{bmdm,jdbcType=VARCHAR})
    </insert>
    <insert id="insertSelective" parameterType="com.scxd.beans.pojo.BizPoliceInfo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into BIZ_POLICE_INFO
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                ID,
            </if>
            <if test="rylx != null">
                RYLX,
            </if>
            <if test="xm != null">
                XM,
            </if>
            <if test="rybh != null">
                RYBH,
            </if>
            <if test="sfzmhm != null">
                SFZMHM,
            </if>
            <if test="sjhm != null">
                SJHM,
            </if>
            <if test="bmdm != null">
                BMDM,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=VARCHAR},
            </if>
            <if test="rylx != null">
                #{rylx,jdbcType=CHAR},
            </if>
            <if test="xm != null">
                #{xm,jdbcType=VARCHAR},
            </if>
            <if test="rybh != null">
                #{rybh,jdbcType=VARCHAR},
            </if>
            <if test="sfzmhm != null">
                #{sfzmhm,jdbcType=VARCHAR},
            </if>
            <if test="sjhm != null">
                #{sjhm,jdbcType=VARCHAR},
            </if>
            <if test="bmdm != null">
                #{bmdm,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.scxd.beans.pojo.BizPoliceInfo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update BIZ_POLICE_INFO
        <set>
            <if test="rylx != null">
                RYLX = #{rylx,jdbcType=CHAR},
            </if>
            <if test="xm != null">
                XM = #{xm,jdbcType=VARCHAR},
            </if>
            <if test="rybh != null">
                RYBH = #{rybh,jdbcType=VARCHAR},
            </if>
            <if test="sfzmhm != null">
                SFZMHM = #{sfzmhm,jdbcType=VARCHAR},
            </if>
            <if test="sjhm != null">
                SJHM = #{sjhm,jdbcType=VARCHAR},
            </if>
            <if test="bmdm != null">
                BMDM = #{bmdm,jdbcType=VARCHAR},
            </if>
        </set>
        where ID = #{id,jdbcType=VARCHAR}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.scxd.beans.pojo.BizPoliceInfo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update BIZ_POLICE_INFO
        set RYLX = #{rylx,jdbcType=CHAR},
        XM = #{xm,jdbcType=VARCHAR},
        RYBH = #{rybh,jdbcType=VARCHAR},
        SFZMHM = #{sfzmhm,jdbcType=VARCHAR},
        SJHM = #{sjhm,jdbcType=VARCHAR},
        BMDM = #{bmdm,jdbcType=VARCHAR}
        where ID = #{id,jdbcType=VARCHAR}
    </update>

    <select id="getPoliceInterFace" parameterType="java.util.Map"
            resultType="com.scxd.beans.pdaBeans.response.CodeValueCommon">
 select A.RYBH CODE,A.XM NAME ,Case When B.RMID Is Null  and a.rybh != #{user} Then 0 Else 1 End As FLAG
From Biz_Police_Info A
INNER JOIN SYS_USER  D ON A.BMDM=D.SSBMBH
Left Outer Join (
Select RMID,PZDM From BIZ_RM_CONFIG M
Inner Join BIZ_RM_CONFIG_DETAIL N On M.ID = N.RMID
Where M.CJR = #{user} AND N.TYPE=#{type}) B
On A.RYBH = B.PZDM
WHERE D.LOGINNAME=#{user}

  </select>
    
    <select id="getPlicesByLoginName" parameterType="java.lang.String" resultType="java.lang.String">
        with T as(
 select A.RYBH CODE,A.XM NAME ,Case When B.RMID Is Null Then 0 Else 1 End As FLAG
From Biz_Police_Info A
INNER JOIN SYS_USER  D ON A.BMDM=D.SSBMBH
Left Outer Join (
Select RMID,PZDM From BIZ_RM_CONFIG M
Inner Join BIZ_RM_CONFIG_DETAIL N On M.ID = N.RMID
Where M.CJR = #{0} AND N.TYPE=2) B
On A.RYBH = B.PZDM
WHERE D.LOGINNAME=#{0})
select to_char(wm_concat(name)) name from T where t.flag=1
    </select>

    <!--删除来源ly = 1 的数据-->
    <delete id="deletePoliceInfoByLy">
        DELETE FROM Biz_Police_Info WHERE fwzbh=#{bmbh}
    </delete>
    <select id="getFWZBHByPoliceBh" resultType="java.lang.String">
    select fwzbh from Biz_Police_Info where rybh=#{user}
</select>
    <!--批量插入-->
    <insert id="insertPoliceInfo" parameterType="java.util.List">

        INSERT ALL
        <foreach collection="policeInfos" item="bean" index="index">
             into BIZ_POLICE_INFO
            <trim prefix="(" suffix=")" suffixOverrides=",">
                <if test="bean.id != null">
                    ID,
                </if>
                <if test="bean.rylx != null">
                    RYLX,
                </if>
                <if test="bean.xm != null">
                    XM,
                </if>
                <if test="bean.rybh != null">
                    RYBH,
                </if>
                <if test="bean.sfzmhm != null">
                    SFZMHM,
                </if>
                <if test="bean.sjhm != null">
                    SJHM,
                </if>
                <if test="bean.bmdm != null">
                    BMDM,
                </if>
                <if test="bean.fwzbh != null">
                    FWZBH,
                </if>
                <if test="bean.ly != null">
                    LY,
                </if>
            </trim>
            <trim prefix="values (" suffix=")" suffixOverrides=",">
                <if test="bean.id != null">
                    #{bean.id,jdbcType=VARCHAR},
                </if>
                <if test="bean.rylx != null">
                    #{bean.rylx ,jdbcType=CHAR},
                </if>
                <if test="bean.xm != null">
                    #{bean.xm,jdbcType=VARCHAR},
                </if>
                <if test="bean.rybh != null">
                    #{bean.rybh,jdbcType=VARCHAR},
                </if>
                <if test="bean.sfzmhm != null">
                    #{bean.sfzmhm,jdbcType=VARCHAR},
                </if>
                <if test="bean.sjhm != null">
                    #{bean.sjhm,jdbcType=VARCHAR},
                </if>
                <if test="bean.bmdm != null">
                    #{bean.bmdm,jdbcType=VARCHAR},
                </if>
                <if test="bean.fwzbh != null">
                    #{bean.fwzbh,jdbcType=VARCHAR},
                </if>
                <if test="bean.ly != null">
                    #{bean.ly ,jdbcType=DECIMAL},
                </if>
            </trim>
        </foreach>
        SELECT 1 FROM DUAL

    </insert>

</mapper>