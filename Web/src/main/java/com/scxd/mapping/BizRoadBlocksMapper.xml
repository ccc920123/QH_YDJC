<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.scxd.dao.mapper.BizRoadBlocksMapper">
    <resultMap id="BaseResultMap" type="com.scxd.beans.pojo.BizRoadBlocks">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="ID" property="id" jdbcType="VARCHAR"/>
        <result column="KKBH" property="kkbh" jdbcType="VARCHAR"/>
        <result column="FXLX" property="fxlx" jdbcType="VARCHAR"/>
        <result column="SXFXLXMC" property="sxfxlxmc" jdbcType="VARCHAR"/>
        <result column="XXFXLXMC" property="xxfxlxmc" jdbcType="VARCHAR"/>
        <result column="KKMC" property="kkmc" jdbcType="VARCHAR"/>
        <result column="KKLX" property="kklx" jdbcType="VARCHAR"/>
        <result column="KKLXMC" property="kklxmc" jdbcType="VARCHAR"/>
        <result column="KKXZ" property="kkxz" jdbcType="DECIMAL"/>
        <result column="KKXZMC" property="kkxzmc" jdbcType="VARCHAR"/>
        <result column="GLBM" property="glbm" jdbcType="VARCHAR"/>
        <result column="XZQH" property="xzqh" jdbcType="VARCHAR"/>
        <result column="XZQHMC" property="xzqhmc" jdbcType="VARCHAR"/>
        <result column="SJXZQH" property="sjxzqh" jdbcType="VARCHAR"/>
        <result column="DLDM" property="dldm" jdbcType="VARCHAR"/>
        <result column="DLMC" property="dlmc" jdbcType="VARCHAR"/>
        <result column="DLLX" property="dllx" jdbcType="CHAR"/>
        <result column="DLLXMC" property="dllxmc" jdbcType="VARCHAR"/>
        <result column="LKH" property="lkh" jdbcType="VARCHAR"/>
        <result column="DLMS" property="dlms" jdbcType="VARCHAR"/>
        <result column="KKJD" property="kkjd" jdbcType="VARCHAR"/>
        <result column="KKWD" property="kkwd" jdbcType="VARCHAR"/>
        <result column="LJTJ" property="ljtj" jdbcType="DECIMAL"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        ID, KKBH, FXLX, SXFXLXMC, XXFXLXMC, KKMC, KKLX, KKLXMC, KKXZ, KKXZMC, GLBM, XZQH,
        XZQHMC, SJXZQH, DLDM, DLMC, DLLX, DLLXMC, LKH, DLMS, KKJD, KKWD, LJTJ
    </sql>
    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        <include refid="Base_Column_List"/>
        from BIZ_ROAD_BLOCKS
        where ID = #{id,jdbcType=VARCHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from BIZ_ROAD_BLOCKS
        where ID = #{id,jdbcType=VARCHAR}
    </delete>
    <insert id="insert" parameterType="com.scxd.beans.pojo.BizRoadBlocks">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into BIZ_ROAD_BLOCKS (ID, KKBH, FXLX,
        SXFXLXMC, XXFXLXMC, KKMC,
        KKLX, KKLXMC, KKXZ,
        KKXZMC, GLBM, XZQH,
        XZQHMC, SJXZQH, DLDM,
        DLMC, DLLX, DLLXMC, LKH,
        DLMS, KKJD, KKWD, LJTJ
        )
        values (#{id,jdbcType=VARCHAR}, #{kkbh,jdbcType=VARCHAR}, #{fxlx,jdbcType=VARCHAR},
        #{sxfxlxmc,jdbcType=VARCHAR}, #{xxfxlxmc,jdbcType=VARCHAR}, #{kkmc,jdbcType=VARCHAR},
        #{kklx,jdbcType=VARCHAR}, #{kklxmc,jdbcType=VARCHAR}, #{kkxz,jdbcType=DECIMAL},
        #{kkxzmc,jdbcType=VARCHAR}, #{glbm,jdbcType=VARCHAR}, #{xzqh,jdbcType=VARCHAR},
        #{xzqhmc,jdbcType=VARCHAR}, #{sjxzqh,jdbcType=VARCHAR}, #{dldm,jdbcType=VARCHAR},
        #{dlmc,jdbcType=VARCHAR}, #{dllx,jdbcType=CHAR}, #{dllxmc,jdbcType=VARCHAR}, #{lkh,jdbcType=VARCHAR},
        #{dlms,jdbcType=VARCHAR}, #{kkjd,jdbcType=VARCHAR}, #{kkwd,jdbcType=VARCHAR}, #{ljtj,jdbcType=DECIMAL}
        )
    </insert>
    <insert id="insertSelective" parameterType="com.scxd.beans.pojo.BizRoadBlocks">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into BIZ_ROAD_BLOCKS
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                ID,
            </if>
            <if test="kkbh != null">
                KKBH,
            </if>
            <if test="fxlx != null">
                FXLX,
            </if>
            <if test="sxfxlxmc != null">
                SXFXLXMC,
            </if>
            <if test="xxfxlxmc != null">
                XXFXLXMC,
            </if>
            <if test="kkmc != null">
                KKMC,
            </if>
            <if test="kklx != null">
                KKLX,
            </if>
            <if test="kklxmc != null">
                KKLXMC,
            </if>
            <if test="kkxz != null">
                KKXZ,
            </if>
            <if test="kkxzmc != null">
                KKXZMC,
            </if>
            <if test="glbm != null">
                GLBM,
            </if>
            <if test="xzqh != null">
                XZQH,
            </if>
            <if test="xzqhmc != null">
                XZQHMC,
            </if>
            <if test="sjxzqh != null">
                SJXZQH,
            </if>
            <if test="dldm != null">
                DLDM,
            </if>
            <if test="dlmc != null">
                DLMC,
            </if>
            <if test="dllx != null">
                DLLX,
            </if>
            <if test="dllxmc != null">
                DLLXMC,
            </if>
            <if test="lkh != null">
                LKH,
            </if>
            <if test="dlms != null">
                DLMS,
            </if>
            <if test="kkjd != null">
                KKJD,
            </if>
            <if test="kkwd != null">
                KKWD,
            </if>
            <if test="ljtj != null">
                LJTJ,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=VARCHAR},
            </if>
            <if test="kkbh != null">
                #{kkbh,jdbcType=VARCHAR},
            </if>
            <if test="fxlx != null">
                #{fxlx,jdbcType=VARCHAR},
            </if>
            <if test="sxfxlxmc != null">
                #{sxfxlxmc,jdbcType=VARCHAR},
            </if>
            <if test="xxfxlxmc != null">
                #{xxfxlxmc,jdbcType=VARCHAR},
            </if>
            <if test="kkmc != null">
                #{kkmc,jdbcType=VARCHAR},
            </if>
            <if test="kklx != null">
                #{kklx,jdbcType=VARCHAR},
            </if>
            <if test="kklxmc != null">
                #{kklxmc,jdbcType=VARCHAR},
            </if>
            <if test="kkxz != null">
                #{kkxz,jdbcType=DECIMAL},
            </if>
            <if test="kkxzmc != null">
                #{kkxzmc,jdbcType=VARCHAR},
            </if>
            <if test="glbm != null">
                #{glbm,jdbcType=VARCHAR},
            </if>
            <if test="xzqh != null">
                #{xzqh,jdbcType=VARCHAR},
            </if>
            <if test="xzqhmc != null">
                #{xzqhmc,jdbcType=VARCHAR},
            </if>
            <if test="sjxzqh != null">
                #{sjxzqh,jdbcType=VARCHAR},
            </if>
            <if test="dldm != null">
                #{dldm,jdbcType=VARCHAR},
            </if>
            <if test="dlmc != null">
                #{dlmc,jdbcType=VARCHAR},
            </if>
            <if test="dllx != null">
                #{dllx,jdbcType=CHAR},
            </if>
            <if test="dllxmc != null">
                #{dllxmc,jdbcType=VARCHAR},
            </if>
            <if test="lkh != null">
                #{lkh,jdbcType=VARCHAR},
            </if>
            <if test="dlms != null">
                #{dlms,jdbcType=VARCHAR},
            </if>
            <if test="kkjd != null">
                #{kkjd,jdbcType=VARCHAR},
            </if>
            <if test="kkwd != null">
                #{kkwd,jdbcType=VARCHAR},
            </if>
            <if test="ljtj != null">
                #{ljtj,jdbcType=DECIMAL},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.scxd.beans.pojo.BizRoadBlocks">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update BIZ_ROAD_BLOCKS
        <set>
            <if test="kkbh != null">
                KKBH = #{kkbh,jdbcType=VARCHAR},
            </if>
            <if test="fxlx != null">
                FXLX = #{fxlx,jdbcType=VARCHAR},
            </if>
            <if test="sxfxlxmc != null">
                SXFXLXMC = #{sxfxlxmc,jdbcType=VARCHAR},
            </if>
            <if test="xxfxlxmc != null">
                XXFXLXMC = #{xxfxlxmc,jdbcType=VARCHAR},
            </if>
            <if test="kkmc != null">
                KKMC = #{kkmc,jdbcType=VARCHAR},
            </if>
            <if test="kklx != null">
                KKLX = #{kklx,jdbcType=VARCHAR},
            </if>
            <if test="kklxmc != null">
                KKLXMC = #{kklxmc,jdbcType=VARCHAR},
            </if>
            <if test="kkxz != null">
                KKXZ = #{kkxz,jdbcType=DECIMAL},
            </if>
            <if test="kkxzmc != null">
                KKXZMC = #{kkxzmc,jdbcType=VARCHAR},
            </if>
            <if test="glbm != null">
                GLBM = #{glbm,jdbcType=VARCHAR},
            </if>
            <if test="xzqh != null">
                XZQH = #{xzqh,jdbcType=VARCHAR},
            </if>
            <if test="xzqhmc != null">
                XZQHMC = #{xzqhmc,jdbcType=VARCHAR},
            </if>
            <if test="sjxzqh != null">
                SJXZQH = #{sjxzqh,jdbcType=VARCHAR},
            </if>
            <if test="dldm != null">
                DLDM = #{dldm,jdbcType=VARCHAR},
            </if>
            <if test="dlmc != null">
                DLMC = #{dlmc,jdbcType=VARCHAR},
            </if>
            <if test="dllx != null">
                DLLX = #{dllx,jdbcType=CHAR},
            </if>
            <if test="dllxmc != null">
                DLLXMC = #{dllxmc,jdbcType=VARCHAR},
            </if>
            <if test="lkh != null">
                LKH = #{lkh,jdbcType=VARCHAR},
            </if>
            <if test="dlms != null">
                DLMS = #{dlms,jdbcType=VARCHAR},
            </if>
            <if test="kkjd != null">
                KKJD = #{kkjd,jdbcType=VARCHAR},
            </if>
            <if test="kkwd != null">
                KKWD = #{kkwd,jdbcType=VARCHAR},
            </if>
            <if test="ljtj != null">
                LJTJ = #{ljtj,jdbcType=DECIMAL},
            </if>
        </set>
        where ID = #{id,jdbcType=VARCHAR}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.scxd.beans.pojo.BizRoadBlocks">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update BIZ_ROAD_BLOCKS
        set KKBH = #{kkbh,jdbcType=VARCHAR},
        FXLX = #{fxlx,jdbcType=VARCHAR},
        SXFXLXMC = #{sxfxlxmc,jdbcType=VARCHAR},
        XXFXLXMC = #{xxfxlxmc,jdbcType=VARCHAR},
        KKMC = #{kkmc,jdbcType=VARCHAR},
        KKLX = #{kklx,jdbcType=VARCHAR},
        KKLXMC = #{kklxmc,jdbcType=VARCHAR},
        KKXZ = #{kkxz,jdbcType=DECIMAL},
        KKXZMC = #{kkxzmc,jdbcType=VARCHAR},
        GLBM = #{glbm,jdbcType=VARCHAR},
        XZQH = #{xzqh,jdbcType=VARCHAR},
        XZQHMC = #{xzqhmc,jdbcType=VARCHAR},
        SJXZQH = #{sjxzqh,jdbcType=VARCHAR},
        DLDM = #{dldm,jdbcType=VARCHAR},
        DLMC = #{dlmc,jdbcType=VARCHAR},
        DLLX = #{dllx,jdbcType=CHAR},
        DLLXMC = #{dllxmc,jdbcType=VARCHAR},
        LKH = #{lkh,jdbcType=VARCHAR},
        DLMS = #{dlms,jdbcType=VARCHAR},
        KKJD = #{kkjd,jdbcType=VARCHAR},
        KKWD = #{kkwd,jdbcType=VARCHAR},
        LJTJ = #{ljtj,jdbcType=DECIMAL}
        where ID = #{id,jdbcType=VARCHAR}
    </update>
    <select id="getKKMessageByBmbh"
            resultType="com.scxd.beans.pdaBeans.response.CodeValueCommon">
    with t as(
    SELECT A.KKBH CODE,A.KKMC NAME ,a.sxfxlxmc,a.xxfxlxmc,CASE WHEN B.RMID IS NULL THEN 0 ELSE 1 END AS FLAG,B.PZZDM
    FROM BIZ_ROAD_BLOCKS A
    LEFT OUTER JOIN (
    SELECT RMID,PZDM,PZZDM FROM BIZ_RM_CONFIG M
    INNER JOIN BIZ_RM_CONFIG_DETAIL N ON M.ID = N.RMID
    WHERE M.CJR =#{user}  AND N.TYPE=#{type}) B
    ON A.KKBH = B.PZDM
    WHERE   A.GLBM=#{bmbh})
   select t.code||'1' code,t.name||'['||t.sxfxlxmc||']' name,CASE WHEN PZZDM = '1' AND t.flag = 1 THEN 1 ELSE 0 END AS flag from t
  where pzzdm='1' or pzzdm is null
  union all
  select t.code||'2',t.name||'['||t.xxfxlxmc||']' name,CASE WHEN PZZDM = '2' AND t.flag = 1 THEN 1 ELSE 0 END AS flag from t
  where pzzdm='2'  or pzzdm is null
  order by flag desc,code
    </select>

    <!--删除来源为1的数据-->
    <delete id="deleteBizRoadBlockByLy">
        DELETE FROM biz_road_blocks WHERE zfzbh=#{bmbh}
    </delete>

    <!--批量插入-->
    <insert id="insertRoadBlocks" parameterType="java.util.List">

        INSERT ALL
        <foreach collection="roadBlocksList" item="bean" index="index">
            INTO biz_road_blocks
            <trim prefix="(" suffix=")" suffixOverrides=",">
                <if test="bean.id != null">
                    ID,
                </if>
                <if test="bean.kkbh != null">
                    KKBH,
                </if>
                <if test="bean.fxlx != null">
                    FXLX,
                </if>
                <if test="bean.sxfxlxmc != null">
                    SXFXLXMC,
                </if>
                <if test="bean.xxfxlxmc != null">
                    XXFXLXMC,
                </if>
                <if test="bean.kkmc != null">
                    KKMC,
                </if>
                <if test="bean.kklx != null">
                    KKLX,
                </if>
                <if test="bean.kklxmc != null">
                    KKLXMC,
                </if>
                <if test="bean.kkxz != null">
                    KKXZ,
                </if>
                <if test="bean.kkxzmc != null">
                    KKXZMC,
                </if>
                <if test="bean.glbm != null">
                    GLBM,
                </if>
                <if test="bean.xzqh != null">
                    XZQH,
                </if>
                <if test="bean.xzqhmc != null">
                    XZQHMC,
                </if>
                <if test="bean.sjxzqh != null">
                    SJXZQH,
                </if>
                <if test="bean.dldm != null">
                    DLDM,
                </if>
                <if test="bean.dlmc != null">
                    DLMC,
                </if>
                <if test="bean.dllx != null">
                    DLLX,
                </if>
                <if test="bean.dllxmc != null">
                    DLLXMC,
                </if>
                <if test="bean.lkh != null">
                    LKH,
                </if>
                <if test="bean.dlms != null">
                    DLMS,
                </if>
                <if test="bean.kkjd != null">
                    KKJD,
                </if>
                <if test="bean.kkwd != null">
                    KKWD,
                </if>
                <if test="bean.ljtj != null">
                    LJTJ,
                </if>
                <if test="bean.zfzbh != null">
                    ZFZBH,
                </if>
                <if test="bean.ly != null">
                    LY,
                </if>
            </trim>
            <trim prefix="values (" suffix=")" suffixOverrides=",">
                <if test="bean.id != null">
                    #{bean.id,jdbcType=VARCHAR},
                </if>
                <if test="bean.kkbh != null">
                    #{bean.kkbh,jdbcType=VARCHAR},
                </if>
                <if test="bean.fxlx != null">
                    #{bean.fxlx,jdbcType=VARCHAR},
                </if>
                <if test="bean.sxfxlxmc != null">
                    #{bean.sxfxlxmc,jdbcType=VARCHAR},
                </if>
                <if test="bean.xxfxlxmc != null">
                    #{bean.xxfxlxmc,jdbcType=VARCHAR},
                </if>
                <if test="bean.kkmc != null">
                    #{bean.kkmc,jdbcType=VARCHAR},
                </if>
                <if test="bean.kklx != null">
                    #{bean.kklx,jdbcType=VARCHAR},
                </if>
                <if test="bean.kklxmc != null">
                    #{bean.kklxmc,jdbcType=VARCHAR},
                </if>
                <if test="bean.kkxz != null">
                    #{bean.kkxz,jdbcType=DECIMAL},
                </if>
                <if test="bean.kkxzmc != null">
                    #{bean.kkxzmc,jdbcType=VARCHAR},
                </if>
                <if test="bean.glbm != null">
                    #{bean.glbm,jdbcType=VARCHAR},
                </if>
                <if test="bean.xzqh != null">
                    #{bean.xzqh,jdbcType=VARCHAR},
                </if>
                <if test="bean.xzqhmc != null">
                    #{bean.xzqhmc,jdbcType=VARCHAR},
                </if>
                <if test="bean.sjxzqh != null">
                    #{bean.sjxzqh,jdbcType=VARCHAR},
                </if>
                <if test="bean.dldm != null">
                    #{bean.dldm,jdbcType=VARCHAR},
                </if>
                <if test="bean.dlmc != null">
                    #{bean.dlmc,jdbcType=VARCHAR},
                </if>
                <if test="bean.dllx != null">
                    #{bean.dllx,jdbcType=CHAR},
                </if>
                <if test="bean.dllxmc != null">
                    #{bean.dllxmc,jdbcType=VARCHAR},
                </if>
                <if test="bean.lkh != null">
                    #{bean.lkh,jdbcType=VARCHAR},
                </if>
                <if test="bean.dlms != null">
                    #{bean.dlms,jdbcType=VARCHAR},
                </if>
                <if test="bean.kkjd != null">
                    #{bean.kkjd,jdbcType=VARCHAR},
                </if>
                <if test="bean.kkwd != null">
                    #{bean.kkwd,jdbcType=VARCHAR},
                </if>
                <if test="bean.ljtj != null">
                    #{bean.ljtj,jdbcType=DECIMAL},
                </if>
                <if test="bean.zfzbh != null">
                    #{bean.zfzbh,jdbcType=VARCHAR},
                </if>
                <if test="bean.ly != null">
                    #{bean.ly,jdbcType=DECIMAL},
                </if>
            </trim>
        </foreach>
        SELECT 1 FROM DUAL
    </insert>
    <!--道路代码-->
    <select id="getRoadItem" resultType="com.scxd.beans.pdaBeans.response.Q26ReturnBean">
        select dldm,dlmc,xzqh from biz_roaditem
        <where>
            glbm= #{sjbmbh}
            <if test="dl!=null and dl !=''">
                and (dldm like concat(concat('%',#{dl}),'%')  or dlmc like concat(concat('%',#{dl}),'%'))
            </if>
        </where>
    </select>
    <!--路段代码-->
    <select id="getRoadSegItem" resultType="com.scxd.beans.pdaBeans.response.Q27ReturnBean">
        select lddm,ldmc   from  biz_roadsegitem where dldm =#{dldm} and glbm=#{sjbmbh}
    </select>
</mapper>