<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.scxd.dao.mapper.BizVioForceMapper">
    <resultMap id="BaseResultMap" type="com.scxd.beans.pojo.BizVioForce">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <result column="ID" property="id" jdbcType="VARCHAR"/>
        <result column="PZBH" property="pzbh" jdbcType="VARCHAR"/>
        <result column="WSLB" property="wslb" jdbcType="CHAR"/>
        <result column="QZCSLX" property="qzcslx" jdbcType="VARCHAR"/>
        <result column="KLWPCFD" property="klwpcfd" jdbcType="VARCHAR"/>
        <result column="SJXM" property="sjxm" jdbcType="VARCHAR"/>
        <result column="SJWPMC" property="sjwpmc" jdbcType="VARCHAR"/>
        <result column="SJWPCFD" property="sjwpcfd" jdbcType="VARCHAR"/>
        <result column="RYFL" property="ryfl" jdbcType="CHAR"/>
        <result column="JSZH" property="jszh" jdbcType="VARCHAR"/>
        <result column="DABH" property="dabh" jdbcType="VARCHAR"/>
        <result column="FZJG" property="fzjg" jdbcType="VARCHAR"/>
        <result column="ZJCX" property="zjcx" jdbcType="VARCHAR"/>
        <result column="DSR" property="dsr" jdbcType="VARCHAR"/>
        <result column="ZSXZQH" property="zsxzqh" jdbcType="VARCHAR"/>
        <result column="ZSXXDZ" property="zsxxdz" jdbcType="VARCHAR"/>
        <result column="DH" property="dh" jdbcType="VARCHAR"/>
        <result column="LXFS" property="lxfs" jdbcType="VARCHAR"/>
        <result column="CLFL" property="clfl" jdbcType="CHAR"/>
        <result column="HPZL" property="hpzl" jdbcType="VARCHAR"/>
        <result column="HPHM" property="hphm" jdbcType="VARCHAR"/>
        <result column="JDCSYR" property="jdcsyr" jdbcType="VARCHAR"/>
        <result column="FDJH" property="fdjh" jdbcType="VARCHAR"/>
        <result column="CLSBDH" property="clsbdh" jdbcType="VARCHAR"/>
        <result column="SYXZ" property="syxz" jdbcType="CHAR"/>
        <result column="JTFS" property="jtfs" jdbcType="VARCHAR"/>
        <result column="WFSJ" property="wfsj" jdbcType="TIMESTAMP"/>
        <result column="XZQH" property="xzqh" jdbcType="VARCHAR"/>
        <result column="WFDD" property="wfdd" jdbcType="VARCHAR"/>
        <result column="LDDM" property="lddm" jdbcType="VARCHAR"/>
        <result column="DDMS" property="ddms" jdbcType="VARCHAR"/>
        <result column="WFDZ" property="wfdz" jdbcType="VARCHAR"/>
        <result column="WFXW1" property="wfxw1" jdbcType="VARCHAR"/>
        <result column="SCZ1" property="scz1" jdbcType="VARCHAR"/>
        <result column="BZZ1" property="bzz1" jdbcType="VARCHAR"/>
        <result column="WFXW2" property="wfxw2" jdbcType="VARCHAR"/>
        <result column="SCZ2" property="scz2" jdbcType="VARCHAR"/>
        <result column="BZZ2" property="bzz2" jdbcType="VARCHAR"/>
        <result column="WFXW3" property="wfxw3" jdbcType="VARCHAR"/>
        <result column="SCZ3" property="scz3" jdbcType="VARCHAR"/>
        <result column="BZZ3" property="bzz3" jdbcType="VARCHAR"/>
        <result column="WFXW4" property="wfxw4" jdbcType="VARCHAR"/>
        <result column="SCZ4" property="scz4" jdbcType="VARCHAR"/>
        <result column="BZZ4" property="bzz4" jdbcType="VARCHAR"/>
        <result column="WFXW5" property="wfxw5" jdbcType="VARCHAR"/>
        <result column="SCZ5" property="scz5" jdbcType="VARCHAR"/>
        <result column="BZZ5" property="bzz5" jdbcType="VARCHAR"/>
        <result column="ZQMJ" property="zqmj" jdbcType="VARCHAR"/>
        <result column="FXJG" property="fxjg" jdbcType="VARCHAR"/>
        <result column="JSJQBJ" property="jsjqbj" jdbcType="VARCHAR"/>
        <result column="SGDJ" property="sgdj" jdbcType="CHAR"/>
        <result column="MJYJ" property="mjyj" jdbcType="VARCHAR"/>
        <result column="JD" property="jd" jdbcType="VARCHAR"/>
        <result column="WD" property="wd" jdbcType="VARCHAR"/>
        <result column="GLS" property="gls" jdbcType="VARCHAR"/>
        <result column="FLYJ" property="flyj" jdbcType="VARCHAR"/>
        <result column="DSRYY" property="dsryy" jdbcType="VARCHAR"/>
        <result column="BZ" property="bz" jdbcType="VARCHAR"/>
        <result column="DYBJ" property="dybj" jdbcType="DECIMAL"/>
        <result column="DYCS" property="dycs" jdbcType="DECIMAL"/>
    </resultMap>
    <insert id="insert" parameterType="com.scxd.beans.pojo.BizVioForce">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into BIZ_VIO_FORCE (ID, PZBH, WSLB,
        QZCSLX, KLWPCFD, SJXM,
        SJWPMC, SJWPCFD, RYFL,
        JSZH, DABH, FZJG, ZJCX,
        DSR, ZSXZQH, ZSXXDZ,
        DH, LXFS, CLFL, HPZL,
        HPHM, JDCSYR, FDJH,
        CLSBDH, SYXZ, JTFS, WFSJ,
        XZQH, WFDD, LDDM, DDMS,
        WFDZ, WFXW1, SCZ1,
        BZZ1, WFXW2, SCZ2,
        BZZ2, WFXW3, SCZ3,
        BZZ3, WFXW4, SCZ4,
        BZZ4, WFXW5, SCZ5,
        BZZ5, ZQMJ, FXJG, JSJQBJ,
        SGDJ, MJYJ, JD, WD,
        GLS, FLYJ, DSRYY, BZ,
        DYBJ, DYCS)
        values (#{id,jdbcType=VARCHAR}, #{pzbh,jdbcType=VARCHAR}, #{wslb,jdbcType=CHAR},
        #{qzcslx,jdbcType=VARCHAR}, #{klwpcfd,jdbcType=VARCHAR}, #{sjxm,jdbcType=VARCHAR},
        #{sjwpmc,jdbcType=VARCHAR}, #{sjwpcfd,jdbcType=VARCHAR}, #{ryfl,jdbcType=CHAR},
        #{jszh,jdbcType=VARCHAR}, #{dabh,jdbcType=VARCHAR}, #{fzjg,jdbcType=VARCHAR}, #{zjcx,jdbcType=VARCHAR},
        #{dsr,jdbcType=VARCHAR}, #{zsxzqh,jdbcType=VARCHAR}, #{zsxxdz,jdbcType=VARCHAR},
        #{dh,jdbcType=VARCHAR}, #{lxfs,jdbcType=VARCHAR}, #{clfl,jdbcType=CHAR}, #{hpzl,jdbcType=VARCHAR},
        #{hphm,jdbcType=VARCHAR}, #{jdcsyr,jdbcType=VARCHAR}, #{fdjh,jdbcType=VARCHAR},
        #{clsbdh,jdbcType=VARCHAR}, #{syxz,jdbcType=CHAR}, #{jtfs,jdbcType=VARCHAR}, #{wfsj,jdbcType=TIMESTAMP},
        #{xzqh,jdbcType=VARCHAR}, #{wfdd,jdbcType=VARCHAR}, #{lddm,jdbcType=VARCHAR}, #{ddms,jdbcType=VARCHAR},
        #{wfdz,jdbcType=VARCHAR}, #{wfxw1,jdbcType=VARCHAR}, #{scz1,jdbcType=VARCHAR},
        #{bzz1,jdbcType=VARCHAR}, #{wfxw2,jdbcType=VARCHAR}, #{scz2,jdbcType=VARCHAR},
        #{bzz2,jdbcType=VARCHAR}, #{wfxw3,jdbcType=VARCHAR}, #{scz3,jdbcType=VARCHAR},
        #{bzz3,jdbcType=VARCHAR}, #{wfxw4,jdbcType=VARCHAR}, #{scz4,jdbcType=VARCHAR},
        #{bzz4,jdbcType=VARCHAR}, #{wfxw5,jdbcType=VARCHAR}, #{scz5,jdbcType=VARCHAR},
        #{bzz5,jdbcType=VARCHAR}, #{zqmj,jdbcType=VARCHAR}, #{fxjg,jdbcType=VARCHAR}, #{jsjqbj,jdbcType=VARCHAR},
        #{sgdj,jdbcType=CHAR}, #{mjyj,jdbcType=VARCHAR}, #{jd,jdbcType=VARCHAR}, #{wd,jdbcType=VARCHAR},
        #{gls,jdbcType=VARCHAR}, #{flyj,jdbcType=VARCHAR}, #{dsryy,jdbcType=VARCHAR}, #{bz,jdbcType=VARCHAR},
        #{dybj,jdbcType=DECIMAL}, #{dycs,jdbcType=DECIMAL})
    </insert>
    <insert id="insertSelective" parameterType="com.scxd.beans.pojo.BizVioForce">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into BIZ_VIO_FORCE
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                ID,
            </if>
            <if test="pzbh != null">
                PZBH,
            </if>
            <if test="wslb != null">
                WSLB,
            </if>
            <if test="qzcslx != null">
                QZCSLX,
            </if>
            <if test="klwpcfd != null">
                KLWPCFD,
            </if>
            <if test="sjxm != null">
                SJXM,
            </if>
            <if test="sjwpmc != null">
                SJWPMC,
            </if>
            <if test="sjwpcfd != null">
                SJWPCFD,
            </if>
            <if test="ryfl != null">
                RYFL,
            </if>
            <if test="jszh != null">
                JSZH,
            </if>
            <if test="dabh != null">
                DABH,
            </if>
            <if test="fzjg != null">
                FZJG,
            </if>
            <if test="zjcx != null">
                ZJCX,
            </if>
            <if test="dsr != null">
                DSR,
            </if>
            <if test="zsxzqh != null">
                ZSXZQH,
            </if>
            <if test="zsxxdz != null">
                ZSXXDZ,
            </if>
            <if test="dh != null">
                DH,
            </if>
            <if test="lxfs != null">
                LXFS,
            </if>
            <if test="clfl != null">
                CLFL,
            </if>
            <if test="hpzl != null">
                HPZL,
            </if>
            <if test="hphm != null">
                HPHM,
            </if>
            <if test="jdcsyr != null">
                JDCSYR,
            </if>
            <if test="fdjh != null">
                FDJH,
            </if>
            <if test="clsbdh != null">
                CLSBDH,
            </if>
            <if test="syxz != null">
                SYXZ,
            </if>
            <if test="jtfs != null">
                JTFS,
            </if>
            <if test="wfsj != null">
                WFSJ,
            </if>
            <if test="xzqh != null">
                XZQH,
            </if>
            <if test="wfdd != null">
                WFDD,
            </if>
            <if test="lddm != null">
                LDDM,
            </if>
            <if test="ddms != null">
                DDMS,
            </if>
            <if test="wfdz != null">
                WFDZ,
            </if>
            <if test="wfxw1 != null">
                WFXW1,
            </if>
            <if test="scz1 != null">
                SCZ1,
            </if>
            <if test="bzz1 != null">
                BZZ1,
            </if>
            <if test="wfxw2 != null">
                WFXW2,
            </if>
            <if test="scz2 != null">
                SCZ2,
            </if>
            <if test="bzz2 != null">
                BZZ2,
            </if>
            <if test="wfxw3 != null">
                WFXW3,
            </if>
            <if test="scz3 != null">
                SCZ3,
            </if>
            <if test="bzz3 != null">
                BZZ3,
            </if>
            <if test="wfxw4 != null">
                WFXW4,
            </if>
            <if test="scz4 != null">
                SCZ4,
            </if>
            <if test="bzz4 != null">
                BZZ4,
            </if>
            <if test="wfxw5 != null">
                WFXW5,
            </if>
            <if test="scz5 != null">
                SCZ5,
            </if>
            <if test="bzz5 != null">
                BZZ5,
            </if>
            <if test="zqmj != null">
                ZQMJ,
            </if>
            <if test="fxjg != null">
                FXJG,
            </if>
            <if test="jsjqbj != null">
                JSJQBJ,
            </if>
            <if test="sgdj != null">
                SGDJ,
            </if>
            <if test="mjyj != null">
                MJYJ,
            </if>
            <if test="jd != null">
                JD,
            </if>
            <if test="wd != null">
                WD,
            </if>
            <if test="gls != null">
                GLS,
            </if>
            <if test="flyj != null">
                FLYJ,
            </if>
            <if test="dsryy != null">
                DSRYY,
            </if>
            <if test="bz != null">
                BZ,
            </if>
            <if test="dybj != null">
                DYBJ,
            </if>
            <if test="dycs != null">
                DYCS,
            </if>
            <if test="lrr != null">
                LRR,
            </if>
            <if test="lxdz != null">
                LXDZ,
            </if>
            <if test="xzssjg != null">
                XZSSJG,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=VARCHAR},
            </if>
            <if test="pzbh != null">
                #{pzbh,jdbcType=VARCHAR},
            </if>
            <if test="wslb != null">
                #{wslb,jdbcType=CHAR},
            </if>
            <if test="qzcslx != null">
                #{qzcslx,jdbcType=VARCHAR},
            </if>
            <if test="klwpcfd != null">
                #{klwpcfd,jdbcType=VARCHAR},
            </if>
            <if test="sjxm != null">
                #{sjxm,jdbcType=VARCHAR},
            </if>
            <if test="sjwpmc != null">
                #{sjwpmc,jdbcType=VARCHAR},
            </if>
            <if test="sjwpcfd != null">
                #{sjwpcfd,jdbcType=VARCHAR},
            </if>
            <if test="ryfl != null">
                #{ryfl,jdbcType=CHAR},
            </if>
            <if test="jszh != null">
                #{jszh,jdbcType=VARCHAR},
            </if>
            <if test="dabh != null">
                #{dabh,jdbcType=VARCHAR},
            </if>
            <if test="fzjg != null">
                #{fzjg,jdbcType=VARCHAR},
            </if>
            <if test="zjcx != null">
                #{zjcx,jdbcType=VARCHAR},
            </if>
            <if test="dsr != null">
                #{dsr,jdbcType=VARCHAR},
            </if>
            <if test="zsxzqh != null">
                #{zsxzqh,jdbcType=VARCHAR},
            </if>
            <if test="zsxxdz != null">
                #{zsxxdz,jdbcType=VARCHAR},
            </if>
            <if test="dh != null">
                #{dh,jdbcType=VARCHAR},
            </if>
            <if test="lxfs != null">
                #{lxfs,jdbcType=VARCHAR},
            </if>
            <if test="clfl != null">
                #{clfl,jdbcType=CHAR},
            </if>
            <if test="hpzl != null">
                #{hpzl,jdbcType=VARCHAR},
            </if>
            <if test="hphm != null">
                #{hphm,jdbcType=VARCHAR},
            </if>
            <if test="jdcsyr != null">
                #{jdcsyr,jdbcType=VARCHAR},
            </if>
            <if test="fdjh != null">
                #{fdjh,jdbcType=VARCHAR},
            </if>
            <if test="clsbdh != null">
                #{clsbdh,jdbcType=VARCHAR},
            </if>
            <if test="syxz != null">
                #{syxz,jdbcType=CHAR},
            </if>
            <if test="jtfs != null">
                #{jtfs,jdbcType=VARCHAR},
            </if>
            <if test="wfsj != null">
                #{wfsj,jdbcType=TIMESTAMP},
            </if>
            <if test="xzqh != null">
                #{xzqh,jdbcType=VARCHAR},
            </if>
            <if test="wfdd != null">
                #{wfdd,jdbcType=VARCHAR},
            </if>
            <if test="lddm != null">
                #{lddm,jdbcType=VARCHAR},
            </if>
            <if test="ddms != null">
                #{ddms,jdbcType=VARCHAR},
            </if>
            <if test="wfdz != null">
                #{wfdz,jdbcType=VARCHAR},
            </if>
            <if test="wfxw1 != null">
                #{wfxw1,jdbcType=VARCHAR},
            </if>
            <if test="scz1 != null">
                #{scz1,jdbcType=VARCHAR},
            </if>
            <if test="bzz1 != null">
                #{bzz1,jdbcType=VARCHAR},
            </if>
            <if test="wfxw2 != null">
                #{wfxw2,jdbcType=VARCHAR},
            </if>
            <if test="scz2 != null">
                #{scz2,jdbcType=VARCHAR},
            </if>
            <if test="bzz2 != null">
                #{bzz2,jdbcType=VARCHAR},
            </if>
            <if test="wfxw3 != null">
                #{wfxw3,jdbcType=VARCHAR},
            </if>
            <if test="scz3 != null">
                #{scz3,jdbcType=VARCHAR},
            </if>
            <if test="bzz3 != null">
                #{bzz3,jdbcType=VARCHAR},
            </if>
            <if test="wfxw4 != null">
                #{wfxw4,jdbcType=VARCHAR},
            </if>
            <if test="scz4 != null">
                #{scz4,jdbcType=VARCHAR},
            </if>
            <if test="bzz4 != null">
                #{bzz4,jdbcType=VARCHAR},
            </if>
            <if test="wfxw5 != null">
                #{wfxw5,jdbcType=VARCHAR},
            </if>
            <if test="scz5 != null">
                #{scz5,jdbcType=VARCHAR},
            </if>
            <if test="bzz5 != null">
                #{bzz5,jdbcType=VARCHAR},
            </if>
            <if test="zqmj != null">
                #{zqmj,jdbcType=VARCHAR},
            </if>
            <if test="fxjg != null">
                #{fxjg,jdbcType=VARCHAR},
            </if>
            <if test="jsjqbj != null">
                #{jsjqbj,jdbcType=VARCHAR},
            </if>
            <if test="sgdj != null">
                #{sgdj,jdbcType=CHAR},
            </if>
            <if test="mjyj != null">
                #{mjyj,jdbcType=VARCHAR},
            </if>
            <if test="jd != null">
                #{jd,jdbcType=VARCHAR},
            </if>
            <if test="wd != null">
                #{wd,jdbcType=VARCHAR},
            </if>
            <if test="gls != null">
                #{gls,jdbcType=VARCHAR},
            </if>
            <if test="flyj != null">
                #{flyj,jdbcType=VARCHAR},
            </if>
            <if test="dsryy != null">
                #{dsryy,jdbcType=VARCHAR},
            </if>
            <if test="bz != null">
                #{bz,jdbcType=VARCHAR},
            </if>
            <if test="dybj != null">
                #{dybj,jdbcType=DECIMAL},
            </if>
            <if test="dycs != null">
                #{dycs,jdbcType=DECIMAL},
            </if>
            <if test="lrr != null">
                #{lrr,jdbcType=VARCHAR},
            </if>
            <if test="lxdz != null">
                #{lxdz,jdbcType=VARCHAR},
            </if>
            <if test="xzssjg != null">
                #{xzssjg,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <select id="getForceDocTotal" resultType="java.lang.Integer">
     select count(*) from biz_vio_force WHERE
        LRR=#{user}
        <choose>
            <when test="ksrq!=null and ksrq!='' and jsrq!=null and jsrq!=''">
                AND WFSJ BETWEEN #{ksrq,jdbcType=TIMESTAMP} AND #{jsrq,jdbcType=TIMESTAMP}
            </when>
            <when test="ksrq!=null and ksrq!='' and (jsrq==null or jsrq=='')">
                AND WFSJ <![CDATA[>=]]> #{ksrq,jdbcType=TIMESTAMP}
            </when>
            <when test="(ksrq==null or ksrq=='') and jsrq!=null and jsrq!=''">
                AND WFSJ <![CDATA[<=]]> #{jsrq,jdbcType=TIMESTAMP}
            </when>
            <otherwise>

            </otherwise>
        </choose>
</select>
    <select id="getForceDocument" resultType="com.scxd.beans.pdaBeans.response.Q18ReturnBean">
        WITH T as (
        SELECT JDSBH,HPZL,HPHM,DSR,JSZH ,QZCS,rownum rn FROM (
        select PZBH JDSBH,HPZL,HPHM,DSR,JSZH ,QZCSLX QZCS from biz_vio_force WHERE
        LRR=#{user}
        <choose>
            <when test="ksrq!=null and ksrq!='' and jsrq!=null and jsrq!=''">
                AND WFSJ BETWEEN #{ksrq,jdbcType=TIMESTAMP} AND #{jsrq,jdbcType=TIMESTAMP}
            </when>
            <when test="ksrq!=null and ksrq!='' and (jsrq==null or jsrq=='')">
                AND WFSJ <![CDATA[>=]]> #{ksrq,jdbcType=TIMESTAMP}
            </when>
            <when test="(ksrq==null or ksrq=='') and jsrq!=null and jsrq!=''">
                AND WFSJ <![CDATA[<=]]> #{jsrq,jdbcType=TIMESTAMP}
            </when>
            <otherwise>

            </otherwise>
        </choose>
        order by wfsj desc
        ))
        SELECT JDSBH,HPZL,HPHM,DSR ,JSZH ,QZCS from T where rn between #{pagefirst} and #{pageend}
    </select>
    <select id="getForceDocumentDetail" resultType="com.scxd.beans.pdaBeans.response.Q21ReturnBean">
SELECT A.HPZL,
PZBH jdsbh,
A.HPHM,
CLFL,
B.CLLX,
B.SYXZ,
B.CSYS,
JDCSYR,
A.FDJH,
A.CLSBDH,
JSZH,
DSR,
A.FZJG,
C.ZJCX,
C.DABH,
C.ZT JSZZT,
C.LJJF LJJF,
DH,
LXFS,
-- C.LXZSXXDZ LXDZ,
A.XZQH,
A.ZSXZQH,
A.ZSXXDZ,
LDDM,
GLS,
DDMS,
WFDD,
/*WFDM,*/
WFDZ,
WFXW1,
JTFS,
WFSJ,
/*D.WFNR,*/
SCZ1,
BZZ1,
T1.Wfnr wfnr1,
T1.FLTW FLYJ1,
WFXW2,
SCZ2,
BZZ2,
T2.Wfnr wfnr2,
T2.FLTW FLYJ2,
WFXW3,
SCZ3,
BZZ3,
T3.Wfnr wfnr3,
T3.FLTW FLYJ3,
WFXW4,
SCZ4,
BZZ4,
T4.Wfnr wfnr4,
T4.FLTW FLYJ4,
WFXW5,
SCZ5,
BZZ5,
T5.Wfnr wfnr5,
T5.FLTW FLYJ5,
K.REALNAME ZQMJ,
FXJG,
FLYJ,
DSRYY,
A.BZ,
SGDJ,
JSJQBJ,
MJYJ,
JD,
WD,
WSLB,
A.RYFL,
A.QZCSLX,
KLWPCFD,
SJXM,
SJWPMC,
A.LXDZ,
H.BMQC ,
G.BMQC SJBM,
A.wsjyw,
'' XZSS,
A.XZSSJG,
SJWPCFD  FROM BIZ_VIO_FORCE  A
LEFT JOIN BIZ_DRV_INFO C ON A.JSZH=C.SFZMHM
LEFT JOIN BIZ_VEH_INFO B ON A.HPZL=B.HPZL AND A.HPHM=B.HPHM
LEFT JOIN  BIZ_CODEWFDM T1 ON A.WFXW1=T1.WFXW
LEFT JOIN  BIZ_CODEWFDM T2 ON A.WFXW2=T2.WFXW
LEFT JOIN  BIZ_CODEWFDM T3 ON A.WFXW3=T3.WFXW
LEFT JOIN  BIZ_CODEWFDM T4 ON A.WFXW4=T4.WFXW
LEFT JOIN  BIZ_CODEWFDM T5 ON A.WFXW5=T5.WFXW
 LEFT JOIN SYS_USER K ON K.LOGINNAME=A.LRR
LEFT JOIN  SYS_DEPARTMENT H ON K.SSBMBH=H.BMBH
LEFT JOIN  SYS_DEPARTMENT G ON  H.SJZDBMBH=G.BMBH
WHERE  PZBH=#{pzbh}
  </select>

    <update id="updatePrint">
        UPDATE BIZ_VIO_FORCE SET DYBJ =1,DYCS=  CASE WHEN DYCS IS NULL THEN 0 ELSE DYCS + 1 END WHERE PZBH=#{xh}
    </update>

    <select id="getForceDocumentBH" resultType="java.lang.String">

        SELECT SEQ_FORCE_DOCMENT.NEXTVAL FROM DUAL
    </select>
    <delete id="deleteVioForceById">
         delete from BIZ_VIO_FORCE
        where ID = #{id,jdbcType=VARCHAR}
    </delete>

    <update id="updateWsjywByPzbh">
        UPDATE BIZ_VIO_FORCE SET WSJYW =#{wsjyw}  WHERE PZBH=#{pzbh}
    </update>
    <select id="getDocumentNumberByBmbhAndUser" resultType="java.lang.String">
        select wsbh from v_vio_document
where wslb = #{wslb} and cjry = #{user} and glbm=#{bmbh} and
xrsj = (
select max(xrsj) from v_vio_document where wslb = #{wslb} and cjry = #{user} and glbm=#{bmbh}) and rownum =1
    </select>
</mapper>