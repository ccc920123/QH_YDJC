<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.scxd.dao.mapper.BizVioViolationMapper">
    <insert id="insert" parameterType="com.scxd.beans.pojo.BizVioViolation">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into BIZ_VIO_VIOLATION (ID, JDSBH, RYFL,
        JSZH, DABH, FZJG, ZJCX,
        DSR, ZSXZQH, ZSXXDZ,
        DH, LXFS, CLFL, HPZL,
        HPHM, JDCSYR, SYXZ, JTFS,
        WFSJ, XZQH, WFDD,
        LDDM, DDMS, WFDZ, WFXW,
        SCZ, BZZ, CFZL, FKJE,
        ZQMJ, JKFS, JKBJ, JKRQ,
        FXJG, CLSJ, JSJQBJ,
        SGDJ, JD, WD, WFJF,
        DYBJ, DYCS, WFDM, GLS,
        WFNR)
        values (#{id,jdbcType=VARCHAR}, #{jdsbh,jdbcType=VARCHAR}, #{ryfl,jdbcType=CHAR},
        #{jszh,jdbcType=VARCHAR}, #{dabh,jdbcType=VARCHAR}, #{fzjg,jdbcType=VARCHAR}, #{zjcx,jdbcType=VARCHAR},
        #{dsr,jdbcType=VARCHAR}, #{zsxzqh,jdbcType=VARCHAR}, #{zsxxdz,jdbcType=VARCHAR},
        #{dh,jdbcType=VARCHAR}, #{lxfs,jdbcType=VARCHAR}, #{clfl,jdbcType=VARCHAR}, #{hpzl,jdbcType=VARCHAR},
        #{hphm,jdbcType=VARCHAR}, #{jdcsyr,jdbcType=VARCHAR}, #{syxz,jdbcType=CHAR}, #{jtfs,jdbcType=CHAR},
        #{wfsj,jdbcType=TIMESTAMP}, #{xzqh,jdbcType=VARCHAR}, #{wfdd,jdbcType=VARCHAR},
        #{lddm,jdbcType=VARCHAR}, #{ddms,jdbcType=VARCHAR}, #{wfdz,jdbcType=VARCHAR}, #{wfxw,jdbcType=VARCHAR},
        #{scz,jdbcType=VARCHAR}, #{bzz,jdbcType=VARCHAR}, #{cfzl,jdbcType=VARCHAR}, #{fkje,jdbcType=DECIMAL},
        #{zqmj,jdbcType=VARCHAR}, #{jkfs,jdbcType=CHAR}, #{jkbj,jdbcType=CHAR}, #{jkrq,jdbcType=TIMESTAMP},
        #{fxjg,jdbcType=VARCHAR}, #{clsj,jdbcType=TIMESTAMP}, #{jsjqbj,jdbcType=CHAR},
        #{sgdj,jdbcType=CHAR}, #{jd,jdbcType=VARCHAR}, #{wd,jdbcType=VARCHAR}, #{wfjf,jdbcType=VARCHAR},
        #{dybj,jdbcType=DECIMAL}, #{dycs,jdbcType=DECIMAL}, #{wfdm,jdbcType=VARCHAR}, #{gls,jdbcType=VARCHAR},
        #{wfnr,jdbcType=VARCHAR})
    </insert>
    <insert id="insertSelective" parameterType="com.scxd.beans.pojo.BizVioViolation">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into BIZ_VIO_VIOLATION
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                ID,
            </if>
            <if test="jdsbh != null">
                JDSBH,
            </if>
            <if test="ryfl != null">
                RYFL,
            </if>
            <if test="jszh != null">
                JSZH,
            </if>
            <if test="dabh != null">
                DABH,
            </if>
            <if test="fzjg != null">
                FZJG,
            </if>
            <if test="zjcx != null">
                ZJCX,
            </if>
            <if test="dsr != null">
                DSR,
            </if>
            <if test="zsxzqh != null">
                ZSXZQH,
            </if>
            <if test="zsxxdz != null">
                ZSXXDZ,
            </if>
            <if test="dh != null">
                DH,
            </if>
            <if test="lxfs != null">
                LXFS,
            </if>
            <if test="clfl != null">
                CLFL,
            </if>
            <if test="hpzl != null">
                HPZL,
            </if>
            <if test="hphm != null">
                HPHM,
            </if>
            <if test="jdcsyr != null">
                JDCSYR,
            </if>
            <if test="syxz != null">
                SYXZ,
            </if>
            <if test="jtfs != null">
                JTFS,
            </if>
            <if test="wfsj != null">
                WFSJ,
            </if>
            <if test="xzqh != null">
                XZQH,
            </if>
            <if test="wfdd != null">
                WFDD,
            </if>
            <if test="lddm != null">
                LDDM,
            </if>
            <if test="ddms != null">
                DDMS,
            </if>
            <if test="wfdz != null">
                WFDZ,
            </if>
            <if test="wfxw != null">
                WFXW,
            </if>
            <if test="scz != null">
                SCZ,
            </if>
            <if test="bzz != null">
                BZZ,
            </if>
            <if test="cfzl != null">
                CFZL,
            </if>
            <if test="fkje != null">
                FKJE,
            </if>
            <if test="zqmj != null">
                ZQMJ,
            </if>
            <if test="jkfs != null">
                JKFS,
            </if>
            <if test="jkbj != null">
                JKBJ,
            </if>
            <if test="jkrq != null">
                JKRQ,
            </if>
            <if test="fxjg != null">
                FXJG,
            </if>
            <if test="clsj != null">
                CLSJ,
            </if>
            <if test="jsjqbj != null">
                JSJQBJ,
            </if>
            <if test="sgdj != null">
                SGDJ,
            </if>
            <if test="jd != null">
                JD,
            </if>
            <if test="wd != null">
                WD,
            </if>
            <if test="wfjf != null">
                WFJF,
            </if>
            <if test="dybj != null">
                DYBJ,
            </if>
            <if test="dycs != null">
                DYCS,
            </if>
            <if test="wfdm != null">
                WFDM,
            </if>
            <if test="gls != null">
                GLS,
            </if>
            <if test="wfnr != null">
                WFNR,
            </if>
            <if test="lrr != null">
                LRR,
            </if>
            <if test="xzssjg != null">
                XZSSJG,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=VARCHAR},
            </if>
            <if test="jdsbh != null">
                #{jdsbh,jdbcType=VARCHAR},
            </if>
            <if test="ryfl != null">
                #{ryfl,jdbcType=CHAR},
            </if>
            <if test="jszh != null">
                #{jszh,jdbcType=VARCHAR},
            </if>
            <if test="dabh != null">
                #{dabh,jdbcType=VARCHAR},
            </if>
            <if test="fzjg != null">
                #{fzjg,jdbcType=VARCHAR},
            </if>
            <if test="zjcx != null">
                #{zjcx,jdbcType=VARCHAR},
            </if>
            <if test="dsr != null">
                #{dsr,jdbcType=VARCHAR},
            </if>
            <if test="zsxzqh != null">
                #{zsxzqh,jdbcType=VARCHAR},
            </if>
            <if test="zsxxdz != null">
                #{zsxxdz,jdbcType=VARCHAR},
            </if>
            <if test="dh != null">
                #{dh,jdbcType=VARCHAR},
            </if>
            <if test="lxfs != null">
                #{lxfs,jdbcType=VARCHAR},
            </if>
            <if test="clfl != null">
                #{clfl,jdbcType=VARCHAR},
            </if>
            <if test="hpzl != null">
                #{hpzl,jdbcType=VARCHAR},
            </if>
            <if test="hphm != null">
                #{hphm,jdbcType=VARCHAR},
            </if>
            <if test="jdcsyr != null">
                #{jdcsyr,jdbcType=VARCHAR},
            </if>
            <if test="syxz != null">
                #{syxz,jdbcType=CHAR},
            </if>
            <if test="jtfs != null">
                #{jtfs,jdbcType=CHAR},
            </if>
            <if test="wfsj != null">
                #{wfsj,jdbcType=TIMESTAMP},
            </if>
            <if test="xzqh != null">
                #{xzqh,jdbcType=VARCHAR},
            </if>
            <if test="wfdd != null">
                #{wfdd,jdbcType=VARCHAR},
            </if>
            <if test="lddm != null">
                #{lddm,jdbcType=VARCHAR},
            </if>
            <if test="ddms != null">
                #{ddms,jdbcType=VARCHAR},
            </if>
            <if test="wfdz != null">
                #{wfdz,jdbcType=VARCHAR},
            </if>
            <if test="wfxw != null">
                #{wfxw,jdbcType=VARCHAR},
            </if>
            <if test="scz != null">
                #{scz,jdbcType=VARCHAR},
            </if>
            <if test="bzz != null">
                #{bzz,jdbcType=VARCHAR},
            </if>
            <if test="cfzl != null">
                #{cfzl,jdbcType=VARCHAR},
            </if>
            <if test="fkje != null">
                #{fkje,jdbcType=DECIMAL},
            </if>
            <if test="zqmj != null">
                #{zqmj,jdbcType=VARCHAR},
            </if>
            <if test="jkfs != null">
                #{jkfs,jdbcType=CHAR},
            </if>
            <if test="jkbj != null">
                #{jkbj,jdbcType=CHAR},
            </if>
            <if test="jkrq != null">
                #{jkrq,jdbcType=TIMESTAMP},
            </if>
            <if test="fxjg != null">
                #{fxjg,jdbcType=VARCHAR},
            </if>
            <if test="clsj != null">
                #{clsj,jdbcType=TIMESTAMP},
            </if>
            <if test="jsjqbj != null">
                #{jsjqbj,jdbcType=CHAR},
            </if>
            <if test="sgdj != null">
                #{sgdj,jdbcType=CHAR},
            </if>
            <if test="jd != null">
                #{jd,jdbcType=VARCHAR},
            </if>
            <if test="wd != null">
                #{wd,jdbcType=VARCHAR},
            </if>
            <if test="wfjf != null">
                #{wfjf,jdbcType=VARCHAR},
            </if>
            <if test="dybj != null">
                #{dybj,jdbcType=DECIMAL},
            </if>
            <if test="dycs != null">
                #{dycs,jdbcType=DECIMAL},
            </if>
            <if test="wfdm != null">
                #{wfdm,jdbcType=VARCHAR},
            </if>
            <if test="gls != null">
                #{gls,jdbcType=VARCHAR},
            </if>
            <if test="wfnr != null">
                #{wfnr,jdbcType=VARCHAR},
            </if>
            <if test="lrr != null">
                #{lrr,jdbcType=VARCHAR},
            </if>
            <if test="xzssjg != null">
                #{xzssjg,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <select id="getSimDocTotal" resultType="java.lang.Integer">
        select count(*)
        from biz_vio_violation
        WHERE lrr = #{user}
        <choose>
            <when test="ksrq!=null and ksrq!='' and jsrq!=null and jsrq!=''">
                AND CLSJ BETWEEN #{ksrq,jdbcType=TIMESTAMP} AND #{jsrq,jdbcType=TIMESTAMP}
            </when>
            <when test="ksrq!=null and ksrq!='' and (jsrq==null or jsrq=='')">
                AND CLSJ <![CDATA[>=]]> #{ksrq,jdbcType=TIMESTAMP}
            </when>
            <when test="(ksrq==null or ksrq=='') and jsrq!=null and jsrq!=''">
                AND CLSJ <![CDATA[<=]]> #{jsrq,jdbcType=TIMESTAMP}
            </when>
            <otherwise>

            </otherwise>

        </choose>
    </select>
    <select id="getSimDocument" resultType="com.scxd.beans.pdaBeans.response.Q17ReturnBean">
        WITH T as (
        select jdsbh ,HPZL,HPHM,DSR,JSZH,rownum rn from (select NVL(JDSBH, '') JDSBH,
        NVL(HPZL, '') HPZL,
        NVL(HPHM, '') HPHM,
        NVL(DSR, '') DSR,
        NVL(JSZH, '') JSZH
        from biz_vio_violation
        WHERE lrr = #{user}
        <choose>
            <when test="ksrq!=null and ksrq!='' and jsrq!=null and jsrq!=''">
                AND CLSJ BETWEEN #{ksrq,jdbcType=TIMESTAMP} AND #{jsrq,jdbcType=TIMESTAMP}
            </when>
            <when test="ksrq!=null and ksrq!='' and (jsrq==null or jsrq=='')">
                AND CLSJ <![CDATA[>=]]> #{ksrq,jdbcType=TIMESTAMP}
            </when>
            <when test="(ksrq==null or ksrq=='') and jsrq!=null and jsrq!=''">
                AND CLSJ <![CDATA[<=]]> #{jsrq,jdbcType=TIMESTAMP}
            </when>
            <otherwise>

            </otherwise>

        </choose>
        order by clsj desc
        ))
        SELECT JDSBH,HPZL, HPHM,DSR,JSZH from T where rn between #{pagefirst} and #{pageend}
    </select>
    <select id="getSimDocumentDetail" resultType="com.scxd.beans.pdaBeans.response.Q20ReturnBean">

   select a.jdsbh,a.hpzl,a.hphm ,a.clfl,b.cllx,a.syxz,b.csys,a.jszh,a.zjcx,a.jtfs,a.dsr,a.fzjg,a.dabh,c.zt jszzt,c.ljjf,
a.dh,a.lxfs,a.xzqh,a.zsxzqh,a.zsxxdz,a.lddm,a.jdcsyr,a.scz,a.bzz,a.gls,a.ddms,a.wfdd,a.wfdz,a.wfxw,a.wfdm,a.wfsj,d.wfnr,d.wfgd flyj,
a.wfjf,
NVL(a.fkje,0) FKJE,
a.cfzl,
k.realname zqmj,
a.jkbj,
a.fxjg,
a.jkrq,
a.jkfs,
a.clsj,
a.jsjqbj,
a.sgdj,
a.ryfl,
'' yh,
g.bmqc  sjbm,
'' xzss,
a.jd,
a.wd,
a.wsjyw,
h.bmqc,
a.xzssjg

 from biz_vio_violation a
 left join biz_veh_info b on a.hpzl=b.hpzl and a.hphm=b.hphm
 left join biz_drv_info c on a.jszh=c.sfzmhm
 left join biz_codewfdm d on d.wfxw=a.wfxw
  left join sys_user k on k.loginname=a.lrr
 left join sys_department h on k.ssbmbh=h.bmbh
 left join sys_department g on h.sjzdbmbh=g.bmbh
 where a.jdsbh=#{jdsbh} and rownum=1
</select>

    <delete id="deleteByBizVioValation" parameterType="java.lang.String">

        delete from BIZ_VIO_VIOLATION
        where ID = #{id,jdbcType=VARCHAR}
</delete>
    <update id="updatePrint">
        UPDATE BIZ_VIO_VIOLATION SET DYBJ =1,DYCS=  CASE WHEN DYCS IS NULL THEN 0 ELSE DYCS + 1 END WHERE JDSBH=#{xh}
    </update>
    <select id="getSimDocumentBH" resultType="java.lang.String">

        SELECT SEQ_SIM_DOCMENT.NEXTVAL FROM DUAL
    </select>
    <update id="updateWsjywByJdsbh">
        update BIZ_VIO_VIOLATION SET WSJYW=#{wsjyw} WHERE JDSBH=#{jdsbh}
    </update>
</mapper>