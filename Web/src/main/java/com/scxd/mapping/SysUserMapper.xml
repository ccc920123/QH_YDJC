<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.scxd.dao.mapper.SysUserMapper">
    <resultMap id="BaseResultMap" type="com.scxd.beans.pojo.SysUser">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <result column="USER_ID" property="userId" jdbcType="INTEGER"/>
        <result column="SSBMBH" property="ssbmbh" jdbcType="VARCHAR"/>
        <result column="LOGINNAME" property="loginname" jdbcType="VARCHAR"/>
        <result column="REALNAME" property="realname" jdbcType="VARCHAR"/>
        <result column="SFZHM" property="sfzhm" jdbcType="VARCHAR"/>
        <result column="MMYXQ" property="mmyxq" jdbcType="DATE"/>
        <result column="LXDH" property="lxdh" jdbcType="VARCHAR"/>
        <result column="KQIPXZ" property="kqipxz" jdbcType="INTEGER"/>
        <result column="IPADDRESS1" property="ipaddress1" jdbcType="VARCHAR"/>
        <result column="IPADDRESS2" property="ipaddress2" jdbcType="VARCHAR"/>
        <result column="IPADDRESS3" property="ipaddress3" jdbcType="VARCHAR"/>
        <result column="ZT" property="zt" jdbcType="INTEGER"/>
        <result column="LXDZ" property="lxdz" jdbcType="VARCHAR"/>
        <result column="BZ" property="bz" jdbcType="VARCHAR"/>
        <result column="CZSJ" property="czsj" jdbcType="DATE"/>
        <result column="CZRYZH" property="czryzh" jdbcType="VARCHAR"/>
        <result column="PASSWORD" property="password" jdbcType="VARCHAR"/>
        <result column="LASTTIME" property="lasttime" jdbcType="DATE"/>
        <result column="PREIPADDRESS" property="preipaddress" jdbcType="VARCHAR"/>
        <result column="SFMJ" property="sfmj" jdbcType="VARCHAR"/>
        <result column="YGBH" property="ygbh" jdbcType="VARCHAR"/>
        <result column="YHYXQ" property="yhyxq" jdbcType="DATE"/>
        <result column="YXQZT" property="yxqzt" jdbcType="VARCHAR"/>
        <result column="SBCS" property="sbcs" jdbcType="INTEGER"/>
        <result column="SBSJ" property="sbsj" jdbcType="DATE"/>
        <result column="SFSYPDA" property="sfsypda" jdbcType="INTEGER"/>
    </resultMap>
    <insert id="insert" parameterType="com.scxd.beans.pojo.SysUser">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into sys_user (USER_ID, SSBMBH, LOGINNAME,
        REALNAME, SFZHM, MMYXQ,
        LXDH, KQIPXZ, IPADDRESS1,
        IPADDRESS2, IPADDRESS3, ZT,
        LXDZ, BZ, CZSJ, CZRYZH,
        PASSWORD, LASTTIME, PREIPADDRESS,
        SFMJ, YGBH, YHYXQ, YXQZT,
        SBCS, SBSJ, SFSYPDA)
        values (#{userId,jdbcType=INTEGER}, #{ssbmbh,jdbcType=VARCHAR}, #{loginname,jdbcType=VARCHAR},
        #{realname,jdbcType=VARCHAR}, #{sfzhm,jdbcType=VARCHAR}, #{mmyxq,jdbcType=DATE},
        #{lxdh,jdbcType=VARCHAR}, #{kqipxz,jdbcType=INTEGER}, #{ipaddress1,jdbcType=VARCHAR},
        #{ipaddress2,jdbcType=VARCHAR}, #{ipaddress3,jdbcType=VARCHAR}, #{zt,jdbcType=INTEGER},
        #{lxdz,jdbcType=VARCHAR}, #{bz,jdbcType=VARCHAR}, #{czsj,jdbcType=DATE}, #{czryzh,jdbcType=VARCHAR},
        #{password,jdbcType=VARCHAR}, #{lasttime,jdbcType=DATE}, #{preipaddress,jdbcType=VARCHAR},
        #{sfmj,jdbcType=VARCHAR}, #{ygbh,jdbcType=VARCHAR}, #{yhyxq,jdbcType=DATE}, #{yxqzt,jdbcType=VARCHAR},
        #{sbcs,jdbcType=INTEGER}, #{sbsj,jdbcType=DATE}, #{sfsypda,jdbcType=INTEGER})
    </insert>
    <insert id="insertSelective" parameterType="com.scxd.beans.pojo.SysUser">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into sys_user
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="userId != null">
                USER_ID,
            </if>
            <if test="ssbmbh != null">
                SSBMBH,
            </if>
            <if test="loginname != null">
                LOGINNAME,
            </if>
            <if test="realname != null">
                REALNAME,
            </if>
            <if test="sfzhm != null">
                SFZHM,
            </if>
            <if test="mmyxq != null">
                MMYXQ,
            </if>
            <if test="lxdh != null">
                LXDH,
            </if>
            <if test="kqipxz != null">
                KQIPXZ,
            </if>
            <if test="ipaddress1 != null">
                IPADDRESS1,
            </if>
            <if test="ipaddress2 != null">
                IPADDRESS2,
            </if>
            <if test="ipaddress3 != null">
                IPADDRESS3,
            </if>
            <if test="zt != null">
                ZT,
            </if>
            <if test="lxdz != null">
                LXDZ,
            </if>
            <if test="bz != null">
                BZ,
            </if>
            <if test="czsj != null">
                CZSJ,
            </if>
            <if test="czryzh != null">
                CZRYZH,
            </if>
            <if test="password != null">
                PASSWORD,
            </if>
            <if test="lasttime != null">
                LASTTIME,
            </if>
            <if test="preipaddress != null">
                PREIPADDRESS,
            </if>
            <if test="sfmj != null">
                SFMJ,
            </if>
            <if test="ygbh != null">
                YGBH,
            </if>
            <if test="yhyxq != null">
                YHYXQ,
            </if>
            <if test="yxqzt != null">
                YXQZT,
            </if>
            <if test="sbcs != null">
                SBCS,
            </if>
            <if test="sbsj != null">
                SBSJ,
            </if>
            <if test="sfsypda != null">
                SFSYPDA,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="userId != null">
                #{userId,jdbcType=INTEGER},
            </if>
            <if test="ssbmbh != null">
                #{ssbmbh,jdbcType=VARCHAR},
            </if>
            <if test="loginname != null">
                #{loginname,jdbcType=VARCHAR},
            </if>
            <if test="realname != null">
                #{realname,jdbcType=VARCHAR},
            </if>
            <if test="sfzhm != null">
                #{sfzhm,jdbcType=VARCHAR},
            </if>
            <if test="mmyxq != null">
                #{mmyxq,jdbcType=DATE},
            </if>
            <if test="lxdh != null">
                #{lxdh,jdbcType=VARCHAR},
            </if>
            <if test="kqipxz != null">
                #{kqipxz,jdbcType=INTEGER},
            </if>
            <if test="ipaddress1 != null">
                #{ipaddress1,jdbcType=VARCHAR},
            </if>
            <if test="ipaddress2 != null">
                #{ipaddress2,jdbcType=VARCHAR},
            </if>
            <if test="ipaddress3 != null">
                #{ipaddress3,jdbcType=VARCHAR},
            </if>
            <if test="zt != null">
                #{zt,jdbcType=INTEGER},
            </if>
            <if test="lxdz != null">
                #{lxdz,jdbcType=VARCHAR},
            </if>
            <if test="bz != null">
                #{bz,jdbcType=VARCHAR},
            </if>
            <if test="czsj != null">
                #{czsj,jdbcType=DATE},
            </if>
            <if test="czryzh != null">
                #{czryzh,jdbcType=VARCHAR},
            </if>
            <if test="password != null">
                #{password,jdbcType=VARCHAR},
            </if>
            <if test="lasttime != null">
                #{lasttime,jdbcType=DATE},
            </if>
            <if test="preipaddress != null">
                #{preipaddress,jdbcType=VARCHAR},
            </if>
            <if test="sfmj != null">
                #{sfmj,jdbcType=VARCHAR},
            </if>
            <if test="ygbh != null">
                #{ygbh,jdbcType=VARCHAR},
            </if>
            <if test="yhyxq != null">
                #{yhyxq,jdbcType=DATE},
            </if>
            <if test="yxqzt != null">
                #{yxqzt,jdbcType=VARCHAR},
            </if>
            <if test="sbcs != null">
                #{sbcs,jdbcType=INTEGER},
            </if>
            <if test="sbsj != null">
                #{sbsj,jdbcType=DATE},
            </if>
            <if test="sfsypda != null">
                #{sfsypda,jdbcType=INTEGER},
            </if>
        </trim>
    </insert>

    <select id="selectByUserName" resultType="com.scxd.beans.pojo.SysUser">
SELECT *
  FROM SYS_USER A
 WHERE A.LOGINNAME = #{0}

  </select>
    <!--查询人员信息以及部门信息，角色-->
    <select id="selectUserByUserName" resultType="com.scxd.beans.common.User">
 SELECT A.*,
       B.NAME AS SSBMNAME,
       DBMS_LOB.SUBSTR(C.ROLES, 4000) ROLES,
       C.ROLESNAME,
       b.id deptid
  FROM SYS_USER A
  LEFT JOIN SYS_DEPARTMENT B
    ON A.SSBMBH = B.BMBH
  LEFT JOIN (SELECT A.USER_ID,
                    WM_CONCAT(TO_CHAR(C.ROLE_ID)) AS ROLES,
                    '' AS ROLESNAME
               FROM SYS_USER A
               JOIN SYS_USER_ROLE B
                 ON A.USER_ID = B.USER_ID
               JOIN SYS_ROLE C
                 ON B.ROLE_ID = C.ROLE_ID
              GROUP BY A.USER_ID) C
    ON A.USER_ID = C.USER_ID
 WHERE A.LOGINNAME = #{0}
  </select>

    <select id="selectPdaUser" parameterType="com.scxd.beans.pdaBeans.request.PdaUser"
            resultType="com.scxd.beans.pdaBeans.response.PdaResponse">
    SELECT LOGINNAME ,T.SSBMBH, D.LEVELNUM+1 SGDJ,
 CASE WHEN D.LEVELNUM=3 THEN D.SJZDBMBH
 ELSE T.SSBMBH
 END SJBMBH ,
 NVL(H.FWZBH,'') FWZBH,
 T.REALNAME XM,T.SFSYPDA,T.PASSWORD,D.NAME BMMC ,'' YHQX,T.ZT zt
 FROM  SYS_USER T LEFT JOIN SYS_DEPARTMENT D ON T.SSBMBH=D.BMBH
 LEFT  JOIN Biz_Police_Info H ON T.LOGINNAME=H.RYBH
    WHERE  T.LOGINNAME=#{user}

  </select>

    <select id="selectBmbhANDRealName" parameterType="java.lang.String" resultType="java.util.Map">
    SELECT REALNAME ,SSBMBH FROM  SYS_USER
    WHERE  LOGINNAME=#{user}

  </select>
    <!--   AND T.PASSWORD=#{password}
        AND T.SSBMBH=#{bmbh}-->

    <!--通过部门编号和用户名来查询用户是否存在-->
    <select id="selectCheckUser" parameterType="String" resultType="int">
    SELECT COUNT(*) FROM sys_user WHERE loginname = #{0} AND ssbmbh = #{1}
  </select>
    <update id="updatePassword">
        update sys_user
        <set>
            <if test="newpwd != null">
                PASSWORD = #{newpwd,jdbcType=VARCHAR},
            </if>

        </set>
        where LOGINNAME = #{user,jdbcType=VARCHAR} and SSBMBH=#{bmbh,jdbcType=VARCHAR}
    </update>

    <select id="selectPwd" resultType="String">
     SELECT password FROM sys_user WHERE loginname = #{0} AND ssbmbh = #{1}
  </select>

    <!--个人中心信息显示补充查询-->
    <select id="selectUserInfo" parameterType="String" resultType="java.util.Map">
    SELECT u.sfzhm FROM sys_user u WHERE u.loginname = #{0} AND u.ssbmbh = #{1}
  </select>
    <select id="getUseById" resultType="com.scxd.beans.common.User">

SELECT A.*,
       B.NAME AS SSBMNAME,
       DBMS_LOB.SUBSTR(C.ROLES, 4000) ROLES,
       C.ROLESNAME,
       ROWNUM AS RN
  FROM SYS_USER A
  LEFT JOIN SYS_DEPARTMENT B
    ON A.SSBMBH = B.BMBH
  LEFT JOIN (SELECT A.USER_ID,
                    WM_CONCAT(TO_CHAR(C.ROLE_ID)) AS ROLES,
                    '' AS ROLESNAME
               FROM SYS_USER A
               JOIN SYS_USER_ROLE B
                 ON A.USER_ID = B.USER_ID
               JOIN SYS_ROLE C
                 ON B.ROLE_ID = C.ROLE_ID
              GROUP BY A.USER_ID) C
    ON A.USER_ID = C.USER_ID

 WHERE A.USER_ID = #{id}
</select>
    <insert id="addUserByUser" parameterType="com.scxd.beans.pojo.SysUser">
        insert into sys_user
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="userId != null">
                USER_ID,
            </if>
            <if test="ssbmbh != null">
                SSBMBH,
            </if>
            <if test="loginname != null">
                LOGINNAME,
            </if>
            <if test="realname != null">
                REALNAME,
            </if>
            <if test="sfzhm != null">
                SFZHM,
            </if>
            <if test="mmyxq != null">
                MMYXQ,
            </if>
            <if test="lxdh != null">
                LXDH,
            </if>
            <if test="kqipxz != null">
                KQIPXZ,
            </if>
            <if test="ipaddress1 != null">
                IPADDRESS1,
            </if>
            <if test="ipaddress2 != null">
                IPADDRESS2,
            </if>
            <if test="ipaddress3 != null">
                IPADDRESS3,
            </if>
            <if test="zt != null">
                ZT,
            </if>
            <if test="lxdz != null">
                LXDZ,
            </if>
            <if test="bz != null">
                BZ,
            </if>
            <if test="czsj != null">
                CZSJ,
            </if>
            <if test="czryzh != null">
                CZRYZH,
            </if>
            <if test="password != null">
                PASSWORD,
            </if>
            <if test="lasttime != null">
                LASTTIME,
            </if>
            <if test="preipaddress != null">
                PREIPADDRESS,
            </if>
            <if test="sfmj != null">
                SFMJ,
            </if>
            <if test="ygbh != null">
                YGBH,
            </if>
            <if test="yhyxq != null">
                YHYXQ,
            </if>
            <if test="yxqzt != null">
                YXQZT,
            </if>
            <if test="sbcs != null">
                SBCS,
            </if>
            <if test="sbsj != null">
                SBSJ,
            </if>
            <if test="sfsypda != null">
                SFSYPDA,
            </if>
            <if test="dlkssj != null">
                DLKSSJ,
            </if>
            <if test="dljssj != null">
                DLJSSJ,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="userId != null">
                #{userId,jdbcType=INTEGER},
            </if>
            <if test="ssbmbh != null">
                #{ssbmbh,jdbcType=VARCHAR},
            </if>
            <if test="loginname != null">
                #{loginname,jdbcType=VARCHAR},
            </if>
            <if test="realname != null">
                #{realname,jdbcType=VARCHAR},
            </if>
            <if test="sfzhm != null">
                #{sfzhm,jdbcType=VARCHAR},
            </if>
            <if test="mmyxq != null">
                #{mmyxq,jdbcType=DATE},
            </if>
            <if test="lxdh != null">
                #{lxdh,jdbcType=VARCHAR},
            </if>
            <if test="kqipxz != null">
                #{kqipxz,jdbcType=INTEGER},
            </if>
            <if test="ipaddress1 != null">
                #{ipaddress1,jdbcType=VARCHAR},
            </if>
            <if test="ipaddress2 != null">
                #{ipaddress2,jdbcType=VARCHAR},
            </if>
            <if test="ipaddress3 != null">
                #{ipaddress3,jdbcType=VARCHAR},
            </if>
            <if test="zt != null">
                #{zt,jdbcType=INTEGER},
            </if>
            <if test="lxdz != null">
                #{lxdz,jdbcType=VARCHAR},
            </if>
            <if test="bz != null">
                #{bz,jdbcType=VARCHAR},
            </if>
            <if test="czsj != null">
                #{czsj,jdbcType=DATE},
            </if>
            <if test="czryzh != null">
                #{czryzh,jdbcType=VARCHAR},
            </if>
            <if test="password != null">
                #{password,jdbcType=VARCHAR},
            </if>
            <if test="lasttime != null">
                #{lasttime,jdbcType=DATE},
            </if>
            <if test="preipaddress != null">
                #{preipaddress,jdbcType=VARCHAR},
            </if>
            <if test="sfmj != null">
                #{sfmj,jdbcType=VARCHAR},
            </if>
            <if test="ygbh != null">
                #{ygbh,jdbcType=VARCHAR},
            </if>
            <if test="yhyxq != null">
                #{yhyxq,jdbcType=DATE},
            </if>
            <if test="yxqzt != null">
                #{yxqzt,jdbcType=VARCHAR},
            </if>
            <if test="sbcs != null">
                #{sbcs,jdbcType=INTEGER},
            </if>
            <if test="sbsj != null">
                #{sbsj,jdbcType=DATE},
            </if>
            <if test="sfsypda != null">
                #{sfsypda,jdbcType=INTEGER},
            </if>
            <if test="dlkssj != null">
                #{dlkssj,jdbcType=VARCHAR},
            </if>
            <if test="dljssj != null">
                #{dljssj,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>

    <insert id="addUserByRole" parameterType="com.scxd.beans.management.RoleBean">
        insert into sys_user_role
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="userId != null">
                USER_ID,
            </if>
            <if test="roleId != null">
                ROLE_ID,
            </if>
            <if test="createtime != null">
                CREATETIME,
            </if>
            <if test="creater != null">
                CREATER,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="userId != null">
                #{userId,jdbcType=VARCHAR},
            </if>
            <if test="roleId != null">
                #{roleId,jdbcType=INTEGER},
            </if>
            <if test="createtime != null">
                #{createtime,jdbcType=DATE},
            </if>
            <if test="creater != null">
                #{creater,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>

    <update id="updateUserByRole" parameterType="com.scxd.beans.management.RoleBean">
        UPDATE  sys_user_role
        <set>
            <if test="roleId != null">
                role_id= #{roleId,jdbcType=INTEGER},
            </if>
            <if test="creater != null">
                creater= #{creater,jdbcType=VARCHAR},
            </if>
        </set>
        WHERE USER_ID=#{userId}
    </update>

    <select id="getSysUserNextID" resultType="java.lang.Integer">
        SELECT SEQ_SYS_USER.NEXTVAL FROM DUAL
    </select>
    <select id="getUserBySfzhm" resultType="java.lang.Integer">
    SELECT COUNT (*) FROM SYS_USER WHERE  SFZHM=#{sfzmhm}
  </select>
    <select id="getUserBySfzhmUpdate" parameterType="com.scxd.beans.pojo.SysUser" resultType="java.lang.Integer">
      select count(*) from sys_user  where user_id != #{userId} and sfzhm = #{sfzhm}
  </select>
    <select id="getUserByYgbhUpdate" parameterType="com.scxd.beans.pojo.SysUser" resultType="java.lang.Integer">
      select count(*) from sys_user  where user_id != #{userId} and ygbh = #{ygbh}
  </select>
    <select id="getUserByLoginname" resultType="java.lang.Integer">
    SELECT COUNT (*) FROM SYS_USER WHERE  LOGINNAME=#{loginname}
  </select>
    <select id="getUserByYgbh" resultType="java.lang.Integer">
    SELECT COUNT (*) FROM SYS_USER WHERE  YGBH=#{ygbh}
  </select>
    <update id="ResetPasswd">
UPDATE  sys_user set password=#{password} where userId=#{id}
    </update>

    <update id="updateBySysUser" parameterType="com.scxd.beans.pojo.SysUser">
        UPDATE  sys_user
        <set>
            <if test="ssbmbh != null">
                SSBMBH=  #{ssbmbh,jdbcType=VARCHAR},
            </if>
            <if test="loginname != null">
                LOGINNAME=   #{loginname,jdbcType=VARCHAR},
            </if>
            <if test="realname != null">
                REALNAME= #{realname,jdbcType=VARCHAR},
            </if>
            <if test="sfzhm != null">
                SFZHM=  #{sfzhm,jdbcType=VARCHAR},
            </if>
            <if test="mmyxq != null">
                MMYXQ=  #{mmyxq,jdbcType=DATE},
            </if>
            <if test="lxdh != null">
                LXDH=  #{lxdh,jdbcType=VARCHAR},
            </if>
            <if test="kqipxz != null">
                KQIPXZ=  #{kqipxz,jdbcType=INTEGER},
            </if>
            <if test="ipaddress1 != null">
                IPADDRESS1=  #{ipaddress1,jdbcType=VARCHAR},
            </if>
            <if test="ipaddress2 != null">
                IPADDRESS2= #{ipaddress2,jdbcType=VARCHAR},
            </if>
            <if test="ipaddress3 != null">
                IPADDRESS3= #{ipaddress3,jdbcType=VARCHAR},
            </if>
            <if test="zt != null">
                ZT= #{zt,jdbcType=INTEGER},
            </if>
            <if test="lxdz != null">
                LXDZ= #{lxdz,jdbcType=VARCHAR},
            </if>
            <if test="bz != null">
                BZ= #{bz,jdbcType=VARCHAR},
            </if>
            <if test="czsj != null">
                CZSJ= #{czsj,jdbcType=DATE},
            </if>
            <if test="czryzh != null">
                CZRYZH= #{czryzh,jdbcType=VARCHAR},
            </if>
            <if test="password != null">
                PASSWORD= #{password,jdbcType=VARCHAR},
            </if>
            <if test="lasttime != null">
                LASTTIME=  #{lasttime,jdbcType=DATE},
            </if>
            <if test="preipaddress != null">
                PREIPADDRESS= #{preipaddress,jdbcType=VARCHAR},
            </if>
            <if test="sfmj != null">
                SFMJ= #{sfmj,jdbcType=VARCHAR},
            </if>
            <if test="ygbh != null">
                YGBH= #{ygbh,jdbcType=VARCHAR},
            </if>
            <if test="yhyxq != null">
                YHYXQ=#{yhyxq,jdbcType=DATE},
            </if>
            <if test="yxqzt != null">
                YXQZT= #{yxqzt,jdbcType=VARCHAR},
            </if>
            <if test="sbcs != null">
                SBCS=#{sbcs,jdbcType=INTEGER},
            </if>
            <if test="sbsj != null">
                SBSJ= #{sbsj,jdbcType=DATE},
            </if>
            <if test="sfsypda != null">
                SFSYPDA= #{sfsypda,jdbcType=INTEGER},
            </if>
            <if test="dlkssj != null">
                DLKSSJ= #{dlkssj,jdbcType=VARCHAR},
            </if>
            <if test="dljssj != null">
                DLJSSJ= #{dljssj,jdbcType=VARCHAR},
            </if>
        </set>
        WHERE USER_ID=#{userId}
    </update>
    <update id="updateLoginDefaltNum">
        UPDATE SYS_USER
        <set>
            <choose>
                <when test="sbcs ==0">
                    SBCS= #{sbcs,jdbcType=INTEGER},
                </when>

                <otherwise>
                    SBCS=  CASE WHEN SBCS IS NULL THEN 1 ELSE SBCS + 1 END
                </otherwise>

            </choose>
            <if test="sbcs = 0">
                SBCS= #{sbcs,jdbcType=VARCHAR},
            </if>
        </set>
        WHERE LOGINNAME=#{username}
    </update>
    <update id="updateLoginIPAndDate">
        UPDATE SYS_USER
        <set>
            <if test="date != null">
                LASTTIME=  #{date},
            </if>
            <if test="ip != null">
                PREIPADDRESS= #{ip,jdbcType=VARCHAR},
            </if>
        </set>
        WHERE LOGINNAME=#{loginname}
    </update>

</mapper>